<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Free PDF Merger - Merge multiple PDF files into one. Combine PDFs online for free.">
    <title>PDF Merger - Free Online Tool | All-in-One Utilities</title>
    <link rel="stylesheet" href="../../css/main.css">
    <link rel="stylesheet" href="../../css/components.css">
    <link rel="stylesheet" href="../../css/tool.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="logo">
                <h1><a href="../../index.html" style="text-decoration: none; color: inherit;">All-in-One Utilities</a></h1>
                <p class="tagline">Free Tools for Everyone</p>
            </div>
            <nav class="nav">
                <a href="../../index.html" class="nav-link">Home</a>
                <a href="../../privacy.html" class="nav-link">Privacy</a>
                <a href="../../terms.html" class="nav-link">Terms</a>
            </nav>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <div class="tool-page">
                <div class="tool-header">
                    <h1>PDF Merger</h1>
                    <p class="tool-description">
                        Merge multiple PDF files into one document. Upload your PDFs, arrange them in order, 
                        and combine them into a single file. All processing happens in your browser.
                    </p>
                </div>

                <!-- AdSense Placeholder - Banner below title -->
                <div class="ad-container ad-banner">
                    <div class="ad-placeholder">Advertisement</div>
                </div>

                <div class="tool-container">
                    <div class="input-section">
                        <div class="file-upload-area" id="upload-area">
                            <div class="file-upload-icon">ðŸ“„</div>
                            <div class="file-upload-text">Click to upload PDF files or drag and drop</div>
                            <div class="file-upload-hint">Select multiple PDF files (Max 50MB per file)</div>
                            <input type="file" id="pdf-input" class="file-input" accept="application/pdf" multiple>
                        </div>
                        <div id="files-list" style="margin-top: 1rem;"></div>
                    </div>

                    <div class="tool-actions">
                        <button type="button" class="btn" id="merge-btn" style="display: none;">Merge PDFs</button>
                        <button type="button" class="btn btn-secondary" id="reset-btn">Reset</button>
                    </div>

                    <div id="result-container" style="display: none;">
                        <div class="result-box">
                            <div class="result-label">PDFs Merged Successfully</div>
                            <div class="tool-actions" style="margin-top: 1rem;">
                                <button type="button" class="btn" id="download-btn">Download Merged PDF</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AdSense Placeholder - After result section -->
                <div class="ad-container ad-banner">
                    <div class="ad-placeholder">Advertisement</div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="ad-container ad-footer">
                <div class="ad-placeholder">Advertisement</div>
            </div>
            <div class="footer-content">
                <p>&copy; 2024 All-in-One Utilities. All rights reserved.</p>
                <div class="footer-links">
                    <a href="../../privacy.html">Privacy Policy</a>
                    <a href="../../terms.html">Terms of Service</a>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="../../js/main.js"></script>
    <script src="../../js/utils.js"></script>
    <script>
        // PDF Merger functionality
        document.addEventListener('DOMContentLoaded', function() {
            const uploadArea = document.getElementById('upload-area');
            const pdfInput = document.getElementById('pdf-input');
            const filesList = document.getElementById('files-list');
            const mergeBtn = document.getElementById('merge-btn');
            const resetBtn = document.getElementById('reset-btn');
            const resultContainer = document.getElementById('result-container');
            const downloadBtn = document.getElementById('download-btn');

            let pdfFiles = [];

            uploadArea.addEventListener('click', () => pdfInput.click());
            pdfInput.addEventListener('change', handleFileSelect);
            mergeBtn.addEventListener('click', mergePDFs);
            resetBtn.addEventListener('click', resetMerger);
            downloadBtn.addEventListener('click', downloadMergedPDF);

            function handleFileSelect(e) {
                const files = Array.from(e.target.files);
                files.forEach(file => {
                    if (file.type === 'application/pdf') {
                        pdfFiles.push(file);
                    }
                });
                updateFilesList();
            }

            function updateFilesList() {
                if (pdfFiles.length === 0) {
                    filesList.innerHTML = '';
                    mergeBtn.style.display = 'none';
                    return;
                }

                filesList.innerHTML = '<h3 class="section-title">Selected Files</h3>';
                pdfFiles.forEach((file, index) => {
                    const fileDiv = document.createElement('div');
                    fileDiv.className = 'grade-entry';
                    fileDiv.innerHTML = `
                        <div class="grade-entry-header">
                            <span class="grade-entry-title">${index + 1}. ${file.name}</span>
                            <button type="button" class="btn btn-danger" style="padding: 0.25rem 0.75rem; font-size: 0.875rem;" onclick="removeFile(${index})">Remove</button>
                        </div>
                        <p style="color: var(--text-secondary); font-size: 0.875rem;">${formatFileSize(file.size)}</p>
                    `;
                    filesList.appendChild(fileDiv);
                });
                mergeBtn.style.display = 'block';
            }

            window.removeFile = function(index) {
                pdfFiles.splice(index, 1);
                updateFilesList();
            };

            async function mergePDFs() {
                if (pdfFiles.length < 2) {
                    showNotification('Please select at least 2 PDF files', 'error');
                    return;
                }

                try {
                    showNotification('Merging PDFs...', 'info');
                    const mergedPdf = await PDFLib.PDFDocument.create();

                    for (const file of pdfFiles) {
                        const arrayBuffer = await file.arrayBuffer();
                        const pdf = await PDFLib.PDFDocument.load(arrayBuffer);
                        const pages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
                        pages.forEach(page => mergedPdf.addPage(page));
                    }

                    const pdfBytes = await mergedPdf.save();
                    const blob = new Blob([pdfBytes], { type: 'application/pdf' });
                    window.mergedPdfBlob = blob;
                    resultContainer.style.display = 'block';
                    showNotification('PDFs merged successfully', 'success');
                } catch (error) {
                    showNotification('Failed to merge PDFs. Please try again.', 'error');
                    console.error(error);
                }
            }

            function downloadMergedPDF() {
                if (!window.mergedPdfBlob) {
                    showNotification('No merged PDF available', 'error');
                    return;
                }

                const url = URL.createObjectURL(window.mergedPdfBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'merged.pdf';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                showNotification('PDF downloaded successfully', 'success');
            }

            function resetMerger() {
                pdfFiles = [];
                pdfInput.value = '';
                filesList.innerHTML = '';
                mergeBtn.style.display = 'none';
                resultContainer.style.display = 'none';
                window.mergedPdfBlob = null;
                showNotification('Merger reset', 'success');
            }
        });
    </script>
</body>
</html>

